<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
<!doctype html>
<html lang="en" class="screen">
<head>
	<meta charset="utf-8">
	<title>RocketBar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="normalize.css" type="text/css">
  <link rel="stylesheet" href="index.css" type="text/css">
  <style type="text/css" media="all">
    /* Demo slides
    ---------------------------------------------------------------------------

    Each slide represents a state. Positioned off-screen to allow layout to
    occur invisibly off to the side. */

    .demo-slides {
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .demo-slide {
      height: 480px;
      width: 320px;
      overflow: hidden;
      position: absolute;
      /* Demo slides are positioned off-screen by default. */
      left: -320px;
      top: 0;
    }
    .demo-slide-activated {
      height: auto;
      min-height: 460px;
      position: static;
    }

    /* Demo Pagination
    ------------------------------------------------------------------------ */

    .demo-slideshow {
      position: relative;
      width: 320px;
    }

    .demo-prev,
    .demo-next {
      bottom: 0;
      position: fixed;
      top: 0;
      width: 30px;
      z-index: 999;
    }

    .demo-prev {
      left: 0;
    }

    .demo-next {
      right: 0;
    }

    #install {
      position: absolute;
      top: 3em;
      right: 0;
      font-size: 1.5em;
      border: 1px solid grey;
      padding: .25em .5em;
      margin: .5em 1em;
      display: none;
      z-index: 1000;
    }
  </style>
</head>
<body>
  <button id="install">Install</button>
  <section class="demo-slideshow" id="demo-slideshow">
    <a class="demo-prev" id="demo-prev" href="#go-prev"></a>
    <a class="demo-next" id="demo-next" href="#go-next"></a>
    <ul id="demo-slides" class="demo-slides">
      <li class="demo-slide">
        <form action="" method="get" class="action-pallette">
          <div class="action-header">
            <div class="action-fields">
              <input type="input" class="action-bar" id="action-bar" placeholder="Search for anything&hellip;" value="">
            </div>
            <ul class="action-completions">
            </ul>
          </div>
          <ul class="action-matches action-list" id="matches">
          </ul>
      </li>
      <li class="demo-slide">
        <form action="" method="get" class="action-pallette">
          <div class="action-header">
            <div class="action-fields">
              <input type="input" class="action-bar" id="action-bar" placeholder="Search for anything&hellip;" value="jo">
            </div>
            <ul class="action-completions">
              <li class="action-completion">
                <a href="#demo-slide-conversation-stream" class="title"><b>Jo</b>hn Doe</a>
              </li>
              <li class="action-completion">
                <span class="title"><b>Jo</b>hnny Fedora</span>
              </li>
            </ul>
          </div>
          <ul class="action-matches action-list" id="matches">
            <li class="action-match messages-gaiamobile-org">
              <section class="action-results">
                <article class="action-result">
                  <h1 class="title">John Doe</h1>
                  <p class="subtitle">Still interested in lunch tomorrow?</p>
                </article>
                <article class="action-result">
                  <h1 class="title">Johnny Fedora</h1>
                  <p class="subtitle">Hey man! I'm in SF. Up for a beer?</p>
                </article>
                <article class="action-result">
                  <h1 class="title">Alice Smith</h1>
                  <p class="subtitle">There's a good burger joint up by Yerba Buena called Super Duper</p>
                </article>
              </section>
            </li>
            <li class="action-match contacts-gaiamobile-org">
              <section class="action-results">
                <article class="action-result">
                  <h1 class="title">John Doe</h1>
                  <p class="subtitle">(555) 555-5555</p>
                </article>
                <article class="action-result">
                  <h1 class="title">Johnny Fedora</h1>
                  <p class="subtitle">(555) 339-5353</p>
                </article>
              </section>
            </li>
            <li class="action-match music-gaiamobile-org">
              <article class="action-entry">
                <h1 class="title">Johnny Cash</h1>
                <span class="subtitle">Artist / 14 songs / 3 Albums</span>
              </article>
            </li>
            <li class="action-match email-gaiamobile-org">
              <section class="action-results">
                <article class="action-result">
                  <h1 class="title">Amy Jo Johnson</h1> <p class="subtitle">Re: Espresso tips from a pro</p>
                </article>
                <article class="action-result">
                  <h1 class="title">Johnny Fedora</h1>
                  <p class="subtitle">Hey man! I'm in SF. Up for a beer?</p>
                </article>
                <article class="action-result">
                  <h1 class="title">Alice Smith</h1>
                  <p class="subtitle">There's a good burger joint up by Yerba Buena called Super Duper</p>
                </article>
              </section>
            </li>
            <li class="action-match facebook-com">
              <section class="action-results">
                <article class="action-result">
                  <h1 class="title">John Doe</h1>
                  <p class="subtitle">Thank you for getting in touch. Yesterday's&hellip;</p>
                </article>
                <article class="action-result">
                  <h1 class="title">Amy Wong</h1>
                  <p class="subtitle">Join us for cocktails and hor'devours this tuesday at&hellip;</p>
                </article>
              </section>
            </li>
            <li class="action-match bookmarks-gaiamobile-org">
              <section class="action-results">
                <article class="action-result">
                  <h1 class="title">Hoefler & Frere-Jones</h1>
                  <p class="subtitle">typography.com</p>
                </article>
                <article class="action-result">
                  <h1 class="title">John Doe's Blog</h1>
                  <p class="subtitle">johndoe.wordpress.com</p>
                </article>
                <article class="action-result">
                  <h1 class="title">The REAL FORK Project by Jon Whitman</h1>
                  <p class="subtitle">kickstarter.com/projects/1061512679</p>
                </article>
             </section>
            </li>
            <li class="action-match browser-gaiamobile-org">
              <article class="action-entry">
                <h1 class="title">Search the web for "jo"</h1>
                <span class="subtitle">Google about 1,060,000,000 results</span>
              </article>
            </li>
          </ul>
        </form>
      </li>
      <li class="demo-slide" id="demo-slide-conversation-stream">
        <form action="" method="get" class="action-pallette">
          <div class="action-header">
            <div class="action-fields">
              <input type="input" class="action-bar" id="action-bar" placeholder="Search for anything&hellip;" value="John Doe">
            </div>
            <div class="action-loading"><span>Loading</span></div>
          </div>
          <ul class="action-matches" id="matches">
            <li class="action-match messages-gaiamobile-org">
              <article class="action-entry">
                <h1 class="title">SMS John Doe</h1>
                <span class="subtitle">(555) 555-5555</span>
              </article>
              <section class="action-results">
                <article class="action-result action-result-unread">
                  <h1 class="title">Still interested in lunch tomorrow?</h1>
                  <p class="subtitle">Yesterday at 9:00am</p>
                </article>
              </section>
            </li>
            <li class="action-match dialer-gaiamobile-org">
              <article class="action-entry">
                <h1 class="title">Call John Doe</h1>
                <span class="subtitle">(555) 555-5555</span>
              </article>
            </li>
            <li class="action-match email-gaiamobile-org">
              <article class="action-entry">
                <h1 class="title">Email John Doe</h1>
                <span class="subtitle">john.doe@example.com</span>
              </article>
              <section class="action-results">
                <article class="action-result action-result-unread">
                  <h1 class="title">In SFO for Asymconf</h1>
                  <p class="subtitle">Yesterday &mdash; I was thinking about using Caltrain since the</p>
                </article>
                <article class="action-result action-result-unread">
                  <h1 class="title">Re: 1.1 Review meeting notes</h1>
                  <p class="subtitle">Jan 23 &mdash; Awesome, thank you sir, that all makes perfect sense :)</p>
                </article>
                <article class="action-result">
                  <h1 class="title">FXOS Icon Guidelines</h1>
                  <p class="subtitle">Dec 11 &mdash; Speaking of which: http://www.mozilla.org/en-US/styleguide/products/firefoxos/icons/</p>
                </article>
              </section>
            </li>
            <li class="action-match facebook-com">
              <article class="action-entry">
                <h1 class="title">Message John Doe</h1>
                <span class="subtitle">Facebook Message</span>
              </article>
              <section class="action-results">
                <article class="action-result">
                  <h1 class="title">Thank you for getting in touch. Yesterday's&hellip;</h1>
                  <p class="subtitle">Yesterday at 9:00am</p>
                </article>
                <article class="action-result">
                  <h1 class="title">I agree. I wonder how long&hellip;</h1>
                  <p class="subtitle">Yesterday at 9:00am</p>
                </article>
                <article class="action-result action-result-unread">
                  <h1 class="title">I should be able to drop by before we&hellip;</h1>
                  <p class="subtitle">Yesterday at 9:00am</p>
                </article>
              </section>
            </li>
            <li class="action-match contacts-gaiamobile-org">
              <article class="action-entry">
                <h1 class="title"> John Doe</h1>
                <span class="subtitle">View contact info</span>
              </article>
            </li>
          </ul>
        </form>
      </li>
      <li class="demo-slide">
        <form action="" method="get" class="action-pallette">
          <div class="action-header">
            <div class="action-fields">
              <input type="input" class="action-bar" id="action-bar" placeholder="Search for anything&hellip;" value="John Doe how about sushi tomorrow?">
            </div>
          </div>
          <ul class="action-matches" id="matches">
            <li class="action-match messages-gaiamobile-org">
              <a class="action-entry" href="#demo-slide-sms-sent">
                <h1 class="title">SMS John Doe</h1>
                <span class="subtitle">how about sushi tomorrow?</span>
              </a>
            </li>
               <li class="action-match email-gaiamobile-org">
              <article class="action-entry">
                <h1 class="title">Email John Doe</h1>
                <span class="subtitle">how about sushi tomorrow?</span>
              </article>
            </li>
            <li class="action-match facebook-com">
              <article class="action-entry">
                <h1 class="title">Message John Doe</h1>
                <span class="subtitle">how about sushi tomorrow?</span>
              </article>
            </li>
          </ul>
        </form>
      </li>
      <li class="demo-slide" id="demo-slide-sms-sent">
        <div class="action-header">
          <div class="action-fields">
            <input type="input" class="action-bar" id="action-bar" placeholder="Search for anything&hellip;" value="">
          </div>
        </div>
        <ul class="action-matches">
          <li class="action-match">
            <h1 class="action-response">Ok, I've sent your message to John Doe:</h1>
            <div class="action-insert">
              <img src="./demo/sms-1.png" width="320" height="200">
            </div>
          </li>
        </ul>
      </li>
      <li class="demo-slide" id="demo-slide-sms-reply">
        <div class="action-header">
          <div class="action-fields">
            <input type="input" class="action-bar" id="action-bar" placeholder="Search for anything&hellip;" value="">
          </div>
        </div>
        <ul class="action-matches">
          <li class="action-match">
            <h1 class="action-response">Ok, I've sent your message to John Doe:</h1>
            <div class="action-insert">
              <img src="./demo/sms-2.png" width="320" height="200">
            </div>
          </li>
        </ul>
      </li>
      <li class="demo-slide">
        <form action="" method="get" class="action-pallette">
          <div class="action-header">
            <div class="action-fields">
              <input type="input" class="action-bar" id="action-bar" placeholder="Search for anything&hellip;" value="sushi">
            </div>
            <div class="action-loading"><span>Loading</span></div>
          </div>
          <ul class="action-matches" id="matches">
            <li class="action-match yelp-com">
              <img class="yelp-com-map" src="./demo/map.png" alt="" width="320" height="100" />

              <section class="action-results">
                <article class="action-result">
                  <h1 class="title">Kiss Seafood</h1>
                  <p class="subtitle">1700 Laguna St / 4 reviews / $$</p>
                </article>
                <article class="action-result">
                  <h1 class="title">Kama Sushi</h1>
                  <p class="subtitle">1497 Church St / 3.5 / $$</p>
                </article>
                <article class="action-result">
                  <h1 class="title">Saru Sushi Bar</h1>
                  <p class="subtitle">3856 24th St / Rating 4.5 / $$</p>
                </article>
                <article class="action-result">
                  <h1 class="title">Sushi Time</h1>
                  <p class="subtitle">3000 24th St / Rating 4.0 / $$$</p>
                </article>
              </section>
            </li>
            <li class="action-match bookmarks-gaiamobile-org">
              <section class="action-results">
                <article class="action-result">
                  <h1 class="title">Sustainable Sushi Guide</h1>
                  <p class="subtitle">sustainablesushi.net &mdash; Trenor uses the topic of sustainable sushi to explore the connection between personal passion and effective activism.</p>
                </article>
             </section>
            </li>
            <li class="action-match browser-gaiamobile-org">
              <section class="action-results">
                <h1 class="title">Web Results for Sushi</h1>
                <article class="action-result">
                  <h1 class="title">Shabu Shabu Sushi</h1>
                  <span class="subtitle">Inner Richmond (Up to 52% Off)</span>
                </article>
                <article class="action-result">
                  <b class="title">Sushi Guide</b>
                  <span class="subtitle">eatsushi.com &mdash; The best, most complete sushi website. With an extensive sushi</span>
                </article>
                <article class="action-result">
                  <b class="title">The Sushi FAQ</b>
                  <span class="subtitle">sushifaq.com &mdash; What is sushi? What is sashimi? The Sushi FAQ is devoted to sushi and its culture.</span>
                </article>
                <article class="action-result">
                  <b class="title">Blowfish Sushi to Die For</b>
                  <span class="subtitle">blowfishsushi.com</span>
                </article>
                <article class="action-result">
                  <b class="title">Tataki</b>
                  <span class="subtitle">tatakisushibar.com</span>
                </article>
              </section>
            </li>
          </ul>
        </form>
      </li>
    </ul>
  </section>
  <script type="text/javascript">
    // Contains all slide app state.
    var STATE = {
      current: 0
    };

    function lambda(method) {
      // Convert a method func that uses a `this` context into a function that takes
      // the context object as the first parameter.
      return function (context) {
        var args = Array.prototype.slice.call(arguments, 1);
        return method.apply(context, args);
      };
    }

    // Create lambda form of indexOf that will work on any array-like.
    var indexOf = lambda(Array.prototype.indexOf);

    function $$(id) {
      // A shortcut for getElementById.
      return document.getElementById(id);
    }

    function $(selector, element) {
      // Shortcut for QSA. QSA is very fussy about how it is invoked
      // so you can't do the usual (x || y).bla() trick.
      return element ?
        element.querySelectorAll(selector) : document.querySelectorAll(selector);
    }

    function within(num, min, max) {
      // Normalize a number such that:
      //
      // * If it is less than min, min will be returned
      // * If it is greater than max, max will be returned.
      // * Otherwise, `num` will be returned.
      return (num < min) ? min : Math.min(num, max);
    }

    function activateSlide(slidesUlEl, index) {
      // Add activated class to child of slidesUlEl
      // Returns index of affected element.
      var children = slidesUlEl.children;
      var childrenLength = children.length;

      // Make sure the index does not fall outside of the range
      // of the number of elements.
      var boundedIndex = within(index, 0, childrenLength - 1);

      var activatedClass = 'demo-slide-activated';

      for (var i = 0; i < childrenLength; i += 1) {
        children[i].classList.remove(activatedClass);
      }

      // Add activated class
      slidesUlEl.children[boundedIndex].classList.add(activatedClass);

      // Return the index affected.
      return boundedIndex;
    }

    function goNextSlide(slidesUlEl, state) {
      return (state.current = activateSlide(slidesUlEl, state.current + 1));
    }

    function goPrevSlide(slidesUlEl, state) {
      return (state.current = activateSlide(slidesUlEl, state.current - 1));
    }

    function getIndexOfFirstChildBySelector(parent, childSelector) {
      var matchingChildren = $(childSelector, parent);
      var firstMatchingChild = matchingChildren[0];
      return indexOf(parent.children, firstMatchingChild);
    }

    function activateSlideBySelector(slidesUlEl, selector, state) {
      var index = getIndexOfFirstChildBySelector(slidesUlEl, selector);
      return (index !== -1) ?
        activateSlide(slidesUlEl, (state.current = index)) : state.current;
    }

    var slidesUlEl = $$('demo-slides');
    var slidesLiEls = slidesUlEl.children;
    var slideshowEl = $$('demo-slideshow');
    var nextEl = $$('demo-next');
    var prevEl = $$('demo-prev');

    var currentSlide = activateSlide(slidesUlEl, 0);

    slideshowEl.addEventListener('click', function (event)  {
      if (event.target === nextEl) {
        goNextSlide(slidesUlEl, STATE);
        event.preventDefault();
      }
      else if (event.target === prevEl) {
        goPrevSlide(slidesUlEl, STATE);
        event.preventDefault();
      }
      else {
        activateSlideBySelector(slidesUlEl, event.target.hash, STATE);
        event.preventDefault();
      }
    });

    if(navigator.mozApps) {
      var btn = document.getElementById('install');

      btn.addEventListener('click', function() {
        navigator.mozApps.install(location.href + 'manifest.webapp');
      });

      var req = navigator.mozApps.getSelf();
      req.onsuccess = function() {
        if(!req.result) {
          document.getElementById('install').style.display = 'block';
        }
      };
    }
  </script>
</body>
</html>
